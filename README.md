# Маркетинг. Категоризация клиентов маркетплейса

## Введение
**Цель работы**: разработать модель для распределения клиентом на условные категории 1 и 0, где 1 - совершит покупки в течение следующих 90 дней, 0 - не совершит.

**Задачи, решаемые в рамках работы:**
1. На основе предоставленных данных сформировать признаки, которые позволят распределить клиентов на категории.
2. Обработать собранные признаки для удаления аномалий, выбросов, пустых значений.
3. Подготовить данные для обучения (закодировать признаки и выполнить масштабирование).
4. Подобрать и обучить модель бинарной классификации.
5. Проверить качество модели по метрике ROC-AUC.
6. Проанализировать работу модели.

**План работы:**
1. Загрузить данные и ознакомиться с ними.
2. Сформировать новые признаки в исходные таблицы.
3. Сгруппировать из исходных данных признаки для категоризации клиентов.
4. Обработать аномальные и выпадающие значения в собранных признаках.
5. Разделить данные на выборки.
6. Подготовить данные для обучения.
7. Сформировать Pipeline с несколькими моделями для нахождения оптимальной.
8. Выгрузить из Pipeline лучшую модель и оценить её качество на валидационной выборке.
9. Проанализировать работу модели, определив, какие признаками вносят наибольший вклад.
10. Сделать выводы по работе.

**Описание работы, предоставленное заказчиком:**

Интернет-магазин собирает историю покупателей, проводит рассылки предложений и планирует будущие продажи. Результаты работы будут использованы для оптимизации процессов.

Предоставленные данные:

Таблица "apparel-purchases": данные о покупках клиентов по дням и по товарам.
- client_id - идентификатор клиента
- quantity - количество единиц товара
- price - цена товара
- category_ids - идентификаторы категорий. Это вложенные категории (например автотовары-аксессуары-освежители), но также может включать в начале списка маркер распродажи или маркер женщинам/мужчинам. Нумерация категорий сквозная для всех уровней, то есть 44 на второй позиции списка или на третьей – это одна и та же категория. Иногда дерево категорий обновляется, поэтому могут меняться вложенности, например ['4', '28', '44', '1594'] или ['4', '44', '1594'].
- date - дата покупки
- message_id - идентификатор сообщения из рассылки

Таблица "apparel-messages": рассылки, которые были отправлены клиентам из таблицы покупок.
- bulk_campaign_id - идентификатор рассылки
- client_id - идентификатор клиента
- message_id - идентификатор сообщения
- event - действие с сообщением (отправлено, открыто, покупка…)
- channel - канал рассылки
- date - дата действия
- created_at - дата-время полностью

Таблица "target": таблица с целевым признаком.
- client_id - идентификатор клиента
- target - клиент совершил покупку в целевом периоде


Таблица "full_campaign_daily_event": агрегация общей базы рассылок по дням и типам событий
- date - дата
- bulk_campaign_id - идентификатор рассылки
- count_event - общее количество каждого события event
- nunique_event - количество уникальных client_id в каждом событии

Таблица "full_campaign_daily_event_channel" - агрегация по дням с учетом событий и каналов рассылки
- date - дата
- bulk_campaign_id - идентификатор рассылки
- count_event_channel - общее количество каждого события по каналам
- nunique_event_channel - количество уникальных client_id по событиям и каналам.

## Выводы
В работе выполнено следующее:
1. Создано около 23 признаков для передачи в модель.
2. Проведен исследовательский и корреляционный анализ данных.
3. Сформирован Pipeline и выбрана наилучшая модель.
4. Проверена работа модели на данных, которые ранее ей не были показаны.
5. Проведен анализ работы модели, установлен вклад каждого признака в модель.

Результаты работы:
1. Наилучшая модель оказалась LogisticRegression с методом подготовки данных 
2. Достигнуто значение метрики ROC-AUC ... на тренировочных данных и ... на валидационных.
3. Наибольший вклад в работу модели вносит количество заказов в 2024 году.

Предложения по улучшению прогноза:
1. Предоставить дополнительные признаки по клиентам, к примеру, пол, возраст.
2. Оптимизировать сбор информации по категориям товаров.